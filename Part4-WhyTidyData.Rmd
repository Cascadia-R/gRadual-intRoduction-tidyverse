---
title: "Tidy Data: Why and How"
author: "Ted Laderas"
date: "5/24/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## What is Tidy Data?

- each row corresponds to an observation
- each variable is a column
- each type of observation is in a different table

![figure/tidy-1.png]

## Why Tidy Data?

Tidy data enables us to do lots of things!

1) Great ggplots
2) Summarize/slice the data in multiple ways
3) Enable Exploratory Data Analysis
4) Ensure assumptions are met for methods
5) Enable Confirmatory Data Analysis

## Beware of columns masquerading as variables!

These columns are actually categories!

Ask yourself: do these columns go together as a single observation for your analysis?

Also ask yourself: What is the unit of observation?

```{r}
library(tidyr)
fertilityData <- read.csv("data/total_fertility.csv", check.names = FALSE)

fertilityData[1:10, 1:10]
```

## Making data tidy: `gather()`

Use `gather()` when you need to make a bunch of columns into one column. 

```{r}
library(tidyr)
fertilityData <- read.csv("data/total_fertility.csv", check.names = FALSE)

#gather() takes three arguments: data, key, and value
#key is what you want your new categorical column to be named
#value is for the actual values in the columns

#We don't want the `Total fertility rate` column to be included as part of the
#gather() operation, so we use the `-` notation to exclude it.

fertilityDataTidy <- 
  gather(fertilityData, "Year", "fertilityRate", -`Total fertility rate`) %>% 
  select(Country = `Total fertility rate`, Year, fertilityRate) %>% 
  #remove na values (there are countries that have no information)
  filter(!is.na(fertilityRate))

fertilityDataTidy[1:10,]
```

## Making one column into many: `spread()`

Sometimes, you will need to go the other direction: take a long format dataset and make it into a more matrix-like format. This is necessary for such functions such as `heatmap()`.

Let's change things around and make the `Country` column into the variables in the dataset.

```{r}
fertilityCountryColumns <- fertilityDataTidy %>% 
  spread(Country, fertilityRate) 

fertilityCountryColumns[1:10, 1:10]
```

## `separate()`

If you have a bunch of values that are in a column and are separated by another delimiter (such as `\t`, or ` `), you can use `separate` to make them into separate columns.

## Your Task:

Take the fertility data and 

## What's Next?

We've showed you the bare basics of the tidyverse.